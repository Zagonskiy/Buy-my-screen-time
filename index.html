<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy My Screen Time</title>
    <style>
        /* --- –ë–∞–∑–æ–≤–∞—è —Ç–µ–º–∞ --- */
        body {
            background-color: #f0f0f0;
            color: #222222;
            font-family: 'Courier New', monospace; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ "—Å–∫—É—á–Ω—ã–π" —à—Ä–∏—Ñ—Ç */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            transition: background-color 0.5s ease, color 0.5s ease;
            position: relative;
        }

        body.dark-mode {
            background-color: #1a1a1a;
            color: #ffffff;
        }

        /* --- –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (–ø–æ–∫—É–ø–∞–µ–º–∞—è) --- */
        body.styled-mode {
            font-family: 'Georgia', serif; /* "–ö—Ä–∞—Å–∏–≤—ã–π" —à—Ä–∏—Ñ—Ç */
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –ø—Ä–∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á—É—Ç—å –∏–∑—è—â–Ω–µ–µ */
        body.styled-mode button {
            font-style: italic;
        }

        /* --- –°—á—ë—Ç—á–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ --- */
        #time-counter {
            font-size: 3rem;
            font-weight: bold;
            transition: all 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            user-select: none;
            cursor: default;
            white-space: nowrap;
        }

        /* –ü–æ–∑–∏—Ü–∏—è —Å–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞) */
        #time-counter.cornered-right {
            position: static; /* –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —á–∞—Å—Ç—å—é –ø–æ—Ç–æ–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ */
            font-size: 1.5rem;
            transform: none;
            margin-bottom: 10px;
        }

        /* –†–∞–º–∫–∞ –¥–ª—è —Å—á–µ—Ç—á–∏–∫–∞ (–ø–æ–∫—É–ø–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π) */
        #time-counter.counter-bordered {
            border: 2px solid currentColor;
            padding: 5px 15px;
            border-radius: 5px;
        }

        /* --- –ü—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä --- */
        .top-right-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end; /* –ü—Ä–∏–∂–∏–º–∞–µ–º –≤—Å—ë –∫ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é */
            z-index: 20;
        }

        /* --- –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ (–ø–æ–∫—É–ø–∞–µ–º–æ–µ) --- */
        #site-title {
            font-size: 4rem;
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            pointer-events: none; /* –ß—Ç–æ–±—ã —Å–∫–≤–æ–∑—å –Ω–µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –∫–ª–∏–∫–∞—Ç—å */
            opacity: 0;
            transition: opacity 1s ease;
            z-index: 0;
        }
        #site-title.visible {
            opacity: 0.1; /* –õ–µ–≥–∫–∏–π —Ñ–æ–Ω */
        }
        body.dark-mode #site-title.visible {
            opacity: 0.05;
        }
        /* –ï—Å–ª–∏ –∫—É–ø–ª–µ–Ω–∞ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è, –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —è—Ä—á–µ –∏ –∫—Ä–∞—Å–∏–≤–µ–µ */
        body.styled-mode #site-title.visible {
            opacity: 1;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 5px;
        }

        /* --- –ú–µ–Ω—é –ø–æ–∫—É–ø–æ–∫ (Shop Menu) --- */
        #shop-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            margin-top: 50px;
            z-index: 10;
        }

        /* –ö–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π */
        .upgrade-btn {
            background: transparent;
            border: none;
            color: inherit;
            cursor: pointer;
            font-size: 1.1rem;
            padding: 10px 20px;
            text-decoration: underline;
            opacity: 0.4;
            transition: all 0.3s;
        }

        .upgrade-btn:disabled {
            cursor: not-allowed;
            text-decoration: none;
        }

        .upgrade-btn:not(:disabled) {
            opacity: 1;
        }

        /* –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–º–æ–∫ –∫–Ω–æ–ø–æ–∫ (–ø–æ–∫—É–ø–∞–µ–º—ã–π) */
        .upgrade-btn.with-borders {
            border: 2px solid currentColor; /* –¶–≤–µ—Ç –±–µ—Ä–µ—Ç—Å—è –æ—Ç —Ç–µ–∫—Å—Ç–∞ */
            text-decoration: none; /* –£–±–∏—Ä–∞–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ, —Ä–∞–∑ –µ—Å—Ç—å —Ä–∞–º–∫–∞ */
        }
        .upgrade-btn.with-borders:hover {
            background-color: rgba(128, 128, 128, 0.1);
        }

        /* –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .hidden {
            display: none !important;
        }

        /* --- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–º–æ–π --- */
        .shop-item-lock {
            opacity: 0.4;
            cursor: not-allowed;
            margin-top: 10px;
            font-size: 1rem;
            user-select: none;
        }
        .shop-item-lock.can-afford {
            opacity: 1;
            cursor: pointer;
            animation: pulse 2s infinite;
        }
        
        .theme-toggle-icon {
            font-size: 1.5rem;
            cursor: pointer;
            margin-top: 10px;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

    <div id="site-title">BUY MY SCREEN TIME</div>

    <div class="top-right-container" id="top-container">
        <div id="theme-lock" class="shop-item-lock">
            üîí –¢–µ–º–∞ (2 –º–∏–Ω)
        </div>
        
        <div id="theme-switch-area" class="hidden">
            <span id="sun-icon" class="theme-toggle-icon">‚òÄÔ∏è</span>
            <span id="moon-icon" class="theme-toggle-icon hidden">üåô</span>
        </div>
    </div>

    <div id="time-counter">0 —Å–µ–∫</div>
    
    <button id="main-interface-btn" class="upgrade-btn" style="font-size: 1.5rem; font-weight: bold; margin-top: 0;" disabled>
        –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (1 –º–∏–Ω)
    </button>

    <div id="shop-menu" class="hidden">
        <button id="btn-title" class="upgrade-btn" disabled>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ (1.5 –º–∏–Ω)</button>
        <button id="btn-styling" class="upgrade-btn" disabled>–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ (3 –º–∏–Ω)</button>
        <button id="btn-borders" class="upgrade-btn" disabled>–ü–æ–∫—É–ø–∫–∞ —Ä–∞–º–æ–∫ (5 –º–∏–Ω)</button>
    </div>

    <script>
        // --- –°–û–°–¢–û–Ø–ù–ò–ï (State) ---
        let state = {
            screenTime: Number(localStorage.getItem('bmst_time')) || 0,
            unlocks: {
                mainInterface: localStorage.getItem('bmst_mainInterface') === 'true',
                siteTitle: localStorage.getItem('bmst_siteTitle') === 'true',
                styling: localStorage.getItem('bmst_styling') === 'true',
                borders: localStorage.getItem('bmst_borders') === 'true',
                themeSwitcher: localStorage.getItem('bmst_themeSwitcher') === 'true'
            },
            isDarkMode: localStorage.getItem('bmst_darkMode') === 'true'
        };

        // --- –¶–ï–ù–´ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) ---
        const COSTS = {
            mainInterface: 60,      // 1 –º–∏–Ω
            siteTitle: 90,          // 1.5 –º–∏–Ω
            themeSwitcher: 120,     // 2 –º–∏–Ω
            styling: 180,           // 3 –º–∏–Ω
            borders: 300            // 5 –º–∏–Ω
        };

        // --- DOM –≠–õ–ï–ú–ï–ù–¢–´ ---
        const els = {
            counter: document.getElementById('time-counter'),
            topContainer: document.getElementById('top-container'),
            title: document.getElementById('site-title'),
            body: document.body,
            
            // –ö–Ω–æ–ø–∫–∏
            btnMain: document.getElementById('main-interface-btn'),
            menuGroup: document.getElementById('shop-menu'),
            btnTitle: document.getElementById('btn-title'),
            btnStyling: document.getElementById('btn-styling'),
            btnBorders: document.getElementById('btn-borders'),
            
            // –¢–µ–º–∞
            lockTheme: document.getElementById('theme-lock'),
            areaTheme: document.getElementById('theme-switch-area'),
            iconSun: document.getElementById('sun-icon'),
            iconMoon: document.getElementById('moon-icon')
        };

        // --- –§–£–ù–ö–¶–ò–ò –°–û–•–†–ê–ù–ï–ù–ò–Ø ---
        function save() {
            localStorage.setItem('bmst_time', state.screenTime);
            localStorage.setItem('bmst_mainInterface', state.unlocks.mainInterface);
            localStorage.setItem('bmst_siteTitle', state.unlocks.siteTitle);
            localStorage.setItem('bmst_styling', state.unlocks.styling);
            localStorage.setItem('bmst_borders', state.unlocks.borders);
            localStorage.setItem('bmst_themeSwitcher', state.unlocks.themeSwitcher);
            localStorage.setItem('bmst_darkMode', state.isDarkMode);
        }

        // --- –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –í–†–ï–ú–ï–ù–ò ---
        function formatTime(s) {
            if (s === 0) return "0 —Å–µ–∫";
            const parts = [];
            const y = Math.floor(s / 31536000);
            const d = Math.floor((s % 31536000) / 86400);
            const h = Math.floor((s % 86400) / 3600);
            const m = Math.floor((s % 3600) / 60);
            const sec = s % 60;

            if (y) parts.push(y + " –≥");
            if (d) parts.push(d + " –¥");
            if (h) parts.push(h + " —á");
            if (m) parts.push(m + " –º–∏–Ω");
            if (sec || !parts.length) parts.push(sec + " —Å–µ–∫");
            return parts.join(' ');
        }

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∞) ---
        function initUI() {
            // –¢–µ–º–∞
            if (state.isDarkMode) {
                els.body.classList.add('dark-mode');
                els.iconSun.classList.add('hidden');
                els.iconMoon.classList.remove('hidden');
            }

            // –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            if (state.unlocks.mainInterface) {
                applyMainInterfaceUnlock(false); // false = –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏
            }

            // –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞
            if (state.unlocks.siteTitle) {
                els.title.classList.add('visible');
                els.btnTitle.innerHTML = "–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ [–ö–£–ü–õ–ï–ù–û]";
                els.btnTitle.disabled = true;
            }

            // –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
            if (state.unlocks.styling) {
                els.body.classList.add('styled-mode');
                els.counter.classList.add('counter-bordered');
                els.btnStyling.innerHTML = "–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è [–ö–£–ü–õ–ï–ù–û]";
                els.btnStyling.disabled = true;
            }

            // –†–∞–º–∫–∏
            if (state.unlocks.borders) {
                applyBorders();
                els.btnBorders.innerHTML = "–ü–æ–∫—É–ø–∫–∞ —Ä–∞–º–æ–∫ [–ö–£–ü–õ–ï–ù–û]";
                els.btnBorders.disabled = true;
            }

            // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ–º—ã
            if (state.unlocks.themeSwitcher) {
                els.lockTheme.classList.add('hidden');
                els.areaTheme.classList.remove('hidden');
            }

            updateCheck();
        }

        // --- –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –≠–§–§–ï–ö–¢–û–í ---
        function applyMainInterfaceUnlock(animate = true) {
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∫—É–ø–∫–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            els.btnMain.classList.add('hidden');
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é
            els.menuGroup.classList.remove('hidden');

            if (animate) {
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –≤ –ø—Ä–∞–≤—ã–π —É–≥–æ–ª
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è CSS transition
                // –ù–æ —Ç–∞–∫ –∫–∞–∫ –º—ã –º–µ–Ω—è–µ–º DOM-—Ä–æ–¥–∏—Ç–µ–ª—è, –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, 
                // –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FLIP –∞–Ω–∏–º–∞—Ü–∏—é. –ó–¥–µ—Å—å —Å–¥–µ–ª–∞–µ–º –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å.
                els.topContainer.prepend(els.counter);
                els.counter.classList.add('cornered-right');
            } else {
                // –ë–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ (–ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ)
                els.topContainer.prepend(els.counter);
                els.counter.classList.add('cornered-right');
            }
        }

        function applyBorders() {
            // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –≤ –º–µ–Ω—é –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å
            const buttons = document.querySelectorAll('.upgrade-btn');
            buttons.forEach(btn => btn.classList.add('with-borders'));
        }

        // --- –ì–õ–ê–í–ù–´–ô –¶–ò–ö–õ ---
        setInterval(() => {
            if (!document.hidden) {
                state.screenTime++;
                els.counter.textContent = formatTime(state.screenTime);
                updateCheck();
                save();
            }
        }, 1000);

        // --- –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –ö–ù–û–ü–û–ö ---
        function updateCheck() {
            const t = state.screenTime;

            // –ö–Ω–æ–ø–∫–∞ "–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å" (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∫—É–ø–ª–µ–Ω–∞)
            if (!state.unlocks.mainInterface) {
                if (t >= COSTS.mainInterface) {
                    els.btnMain.disabled = false;
                } else {
                    els.btnMain.disabled = true;
                }
            } else {
                // –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫—É–ø–ª–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
                
                // –ù–∞–∑–≤–∞–Ω–∏–µ
                if (!state.unlocks.siteTitle) {
                    els.btnTitle.disabled = (t < COSTS.siteTitle);
                }

                // –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
                if (!state.unlocks.styling) {
                    els.btnStyling.disabled = (t < COSTS.styling);
                }

                // –†–∞–º–∫–∏
                if (!state.unlocks.borders) {
                    els.btnBorders.disabled = (t < COSTS.borders);
                }
            }

            // –¢–µ–º–∞ (–Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–µ–Ω—é, –≤–∏—Å–∏—Ç –≤ —É–≥–ª—É)
            if (!state.unlocks.themeSwitcher) {
                if (t >= COSTS.themeSwitcher) {
                    els.lockTheme.classList.add('can-afford');
                    els.lockTheme.textContent = "üîì –û—Ç–∫—Ä—ã—Ç—å —Ç–µ–º—É";
                } else {
                    els.lockTheme.classList.remove('can-afford');
                }
            }
        }

        // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–õ–ò–ö–û–í ---

        // 1. –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        els.btnMain.addEventListener('click', () => {
            if (state.screenTime >= COSTS.mainInterface) {
                state.unlocks.mainInterface = true;
                applyMainInterfaceUnlock(true);
                save();
                updateCheck();
            }
        });

        // 2. –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞
        els.btnTitle.addEventListener('click', () => {
            if (state.screenTime >= COSTS.siteTitle && !state.unlocks.siteTitle) {
                state.unlocks.siteTitle = true;
                els.title.classList.add('visible');
                
                els.btnTitle.innerHTML = "–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ [–ö–£–ü–õ–ï–ù–û]";
                els.btnTitle.disabled = true;
                save();
            }
        });

        // 3. –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
        els.btnStyling.addEventListener('click', () => {
            if (state.screenTime >= COSTS.styling && !state.unlocks.styling) {
                state.unlocks.styling = true;
                els.body.classList.add('styled-mode');
                els.counter.classList.add('counter-bordered');
                
                els.btnStyling.innerHTML = "–°—Ç–∏–ª–∏–∑–∞—Ü–∏—è [–ö–£–ü–õ–ï–ù–û]";
                els.btnStyling.disabled = true;
                save();
            }
        });

        // 4. –†–∞–º–∫–∏
        els.btnBorders.addEventListener('click', () => {
            if (state.screenTime >= COSTS.borders && !state.unlocks.borders) {
                state.unlocks.borders = true;
                applyBorders();
                
                els.btnBorders.innerHTML = "–ü–æ–∫—É–ø–∫–∞ —Ä–∞–º–æ–∫ [–ö–£–ü–õ–ï–ù–û]";
                els.btnBorders.disabled = true;
                save();
            }
        });

        // 5. –ü–æ–∫—É–ø–∫–∞ –¢–µ–º—ã
        els.lockTheme.addEventListener('click', () => {
            if (!state.unlocks.themeSwitcher && state.screenTime >= COSTS.themeSwitcher) {
                state.unlocks.themeSwitcher = true;
                els.lockTheme.classList.add('hidden');
                els.areaTheme.classList.remove('hidden');
                save();
            }
        });

        // 6. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        function toggleTheme() {
            state.isDarkMode = !state.isDarkMode;
            els.body.classList.toggle('dark-mode', state.isDarkMode);
            els.iconSun.classList.toggle('hidden', state.isDarkMode);
            els.iconMoon.classList.toggle('hidden', !state.isDarkMode);
            save();
        }
        els.iconSun.addEventListener('click', toggleTheme);
        els.iconMoon.addEventListener('click', toggleTheme);

        // –°—Ç–∞—Ä—Ç
        initUI();

    </script>
</body>
</html>
